<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: AISH_Query_Flow Pages: 1 -->
<svg width="492pt" height="757pt"
 viewBox="0.00 0.00 492.00 757.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 753)">
<title>AISH_Query_Flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-753 488,-753 488,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_process</title>
<polygon fill="lightgrey" stroke="lightgrey" points="8,-8 8,-672 476,-672 476,-8 8,-8"/>
<text text-anchor="middle" x="242" y="-656.8" font-family="Times,serif" font-size="14.00">Query Processing Cycle</text>
</g>
<!-- user_input -->
<g id="node1" class="node">
<title>user_input</title>
<ellipse fill="lightyellow" stroke="black" cx="279" cy="-623" rx="61.19" ry="18"/>
<text text-anchor="middle" x="279" y="-619.3" font-family="Times,serif" font-size="14.00">User Input</text>
</g>
<!-- process_query -->
<g id="node2" class="node">
<title>process_query</title>
<polygon fill="lightblue" stroke="black" points="282.5,-543 141.5,-543 141.5,-505 282.5,-505 282.5,-543"/>
<text text-anchor="middle" x="212" y="-527.8" font-family="Times,serif" font-size="14.00">process_question</text>
<text text-anchor="middle" x="212" y="-512.8" font-family="Times,serif" font-size="14.00">(process_query.jl)</text>
</g>
<!-- user_input&#45;&gt;process_query -->
<g id="edge1" class="edge">
<title>user_input&#45;&gt;process_query</title>
<path fill="none" stroke="black" d="M239.08,-609.32C228.84,-604.07 219.03,-596.84 213,-587 206.95,-577.12 205.81,-564.59 206.52,-553.39"/>
<polygon fill="black" stroke="black" points="210.03,-553.51 207.67,-543.18 203.07,-552.73 210.03,-553.51"/>
<text text-anchor="middle" x="277.5" y="-577.4" font-family="Times,serif" font-size="12.00">User message +</text>
<text text-anchor="middle" x="277.5" y="-564.4" font-family="Times,serif" font-size="12.00">Previous shell results</text>
</g>
<!-- prepare_msg -->
<g id="node3" class="node">
<title>prepare_msg</title>
<polygon fill="lightgreen" stroke="black" stroke-dasharray="5,2" points="305,-456 119,-456 119,-418 305,-418 305,-456"/>
<text text-anchor="middle" x="212" y="-440.8" font-family="Times,serif" font-size="14.00">prepare_user_message!</text>
<text text-anchor="middle" x="212" y="-425.8" font-family="Times,serif" font-size="14.00">(AI_contexter.jl)</text>
</g>
<!-- process_query&#45;&gt;prepare_msg -->
<g id="edge2" class="edge">
<title>process_query&#45;&gt;prepare_msg</title>
<path fill="none" stroke="black" d="M212,-504.97C212,-493.7 212,-478.95 212,-466.16"/>
<polygon fill="black" stroke="black" points="215.5,-466 212,-456 208.5,-466 215.5,-466"/>
<text text-anchor="middle" x="253" y="-477.4" font-family="Times,serif" font-size="12.00">Contextualize</text>
</g>
<!-- add_user_msg -->
<g id="node4" class="node">
<title>add_user_msg</title>
<polygon fill="lightblue" stroke="black" points="317.5,-381 106.5,-381 106.5,-343 317.5,-343 317.5,-381"/>
<text text-anchor="middle" x="212" y="-365.8" font-family="Times,serif" font-size="14.00">add_n_save_user_message!</text>
<text text-anchor="middle" x="212" y="-350.8" font-family="Times,serif" font-size="14.00">(messages.jl)</text>
</g>
<!-- prepare_msg&#45;&gt;add_user_msg -->
<g id="edge3" class="edge">
<title>prepare_msg&#45;&gt;add_user_msg</title>
<path fill="none" stroke="black" d="M212,-417.96C212,-409.88 212,-400.18 212,-391.18"/>
<polygon fill="black" stroke="black" points="215.5,-391.09 212,-381.09 208.5,-391.09 215.5,-391.09"/>
</g>
<!-- ai_stream -->
<g id="node5" class="node">
<title>ai_stream</title>
<polygon fill="lightyellow" stroke="black" points="306,-294 118,-294 118,-241 306,-241 306,-294"/>
<text text-anchor="middle" x="212" y="-278.8" font-family="Times,serif" font-size="14.00">ai_stream_safe</text>
<text text-anchor="middle" x="212" y="-263.8" font-family="Times,serif" font-size="14.00">(anthropic_extension.jl)</text>
<text text-anchor="middle" x="212" y="-248.8" font-family="Times,serif" font-size="14.00">AI Response Generation</text>
</g>
<!-- add_user_msg&#45;&gt;ai_stream -->
<g id="edge4" class="edge">
<title>add_user_msg&#45;&gt;ai_stream</title>
<path fill="none" stroke="black" d="M212,-342.72C212,-331.76 212,-317.43 212,-304.29"/>
<polygon fill="black" stroke="black" points="215.5,-304.09 212,-294.09 208.5,-304.09 215.5,-304.09"/>
</g>
<!-- extract_shell -->
<g id="node6" class="node">
<title>extract_shell</title>
<polygon fill="lightblue" stroke="black" points="307.5,-204 116.5,-204 116.5,-166 307.5,-166 307.5,-204"/>
<text text-anchor="middle" x="212" y="-188.8" font-family="Times,serif" font-size="14.00">extract_shell_commands</text>
<text text-anchor="middle" x="212" y="-173.8" font-family="Times,serif" font-size="14.00">(shell_processing.jl)</text>
</g>
<!-- ai_stream&#45;&gt;extract_shell -->
<g id="edge5" class="edge">
<title>ai_stream&#45;&gt;extract_shell</title>
<path fill="none" stroke="black" d="M212,-240.59C212,-232.31 212,-223.11 212,-214.65"/>
<polygon fill="black" stroke="black" points="215.5,-214.47 212,-204.47 208.5,-214.47 215.5,-214.47"/>
</g>
<!-- execute_shell -->
<g id="node7" class="node">
<title>execute_shell</title>
<polygon fill="lightblue" stroke="black" points="310,-129 114,-129 114,-91 310,-91 310,-129"/>
<text text-anchor="middle" x="212" y="-113.8" font-family="Times,serif" font-size="14.00">execute_shell_commands</text>
<text text-anchor="middle" x="212" y="-98.8" font-family="Times,serif" font-size="14.00">(shell_processing.jl)</text>
</g>
<!-- extract_shell&#45;&gt;execute_shell -->
<g id="edge6" class="edge">
<title>extract_shell&#45;&gt;execute_shell</title>
<path fill="none" stroke="black" d="M212,-165.96C212,-157.88 212,-148.18 212,-139.18"/>
<polygon fill="black" stroke="black" points="215.5,-139.09 212,-129.09 208.5,-139.09 215.5,-139.09"/>
</g>
<!-- add_ai_msg -->
<g id="node8" class="node">
<title>add_ai_msg</title>
<polygon fill="lightblue" stroke="black" points="208,-54 16,-54 16,-16 208,-16 208,-54"/>
<text text-anchor="middle" x="112" y="-38.8" font-family="Times,serif" font-size="14.00">add_n_save_ai_message!</text>
<text text-anchor="middle" x="112" y="-23.8" font-family="Times,serif" font-size="14.00">(messages.jl)</text>
</g>
<!-- execute_shell&#45;&gt;add_ai_msg -->
<g id="edge7" class="edge">
<title>execute_shell&#45;&gt;add_ai_msg</title>
<path fill="none" stroke="black" d="M187.28,-90.96C174.54,-81.65 158.83,-70.18 145.06,-60.13"/>
<polygon fill="black" stroke="black" points="146.92,-57.16 136.78,-54.09 142.79,-62.81 146.92,-57.16"/>
</g>
<!-- shell_results -->
<g id="node9" class="node">
<title>shell_results</title>
<ellipse fill="lightyellow" stroke="black" cx="347" cy="-35" rx="120.78" ry="18"/>
<text text-anchor="middle" x="347" y="-31.3" font-family="Times,serif" font-size="14.00">Shell Execution Results</text>
</g>
<!-- execute_shell&#45;&gt;shell_results -->
<g id="edge8" class="edge">
<title>execute_shell&#45;&gt;shell_results</title>
<path fill="none" stroke="black" d="M245.37,-90.96C264.11,-80.82 287.61,-68.11 307.29,-57.47"/>
<polygon fill="black" stroke="black" points="309.19,-60.42 316.32,-52.59 305.86,-54.27 309.19,-60.42"/>
</g>
<!-- shell_results&#45;&gt;user_input -->
<g id="edge9" class="edge">
<title>shell_results&#45;&gt;user_input</title>
<path fill="none" stroke="black" d="M347,-53.11C347,-67.9 347,-89.86 347,-109 347,-525 347,-525 347,-525 347,-552.65 356.97,-563.76 342,-587 337.86,-593.44 332.09,-598.8 325.72,-603.23"/>
<polygon fill="black" stroke="black" points="323.46,-600.5 316.75,-608.7 327.11,-606.48 323.46,-600.5"/>
<text text-anchor="middle" x="389.5" y="-315.4" font-family="Times,serif" font-size="12.00">Next iteration</text>
</g>
<!-- start -->
<g id="node10" class="node">
<title>start</title>
<polygon fill="lightgreen" stroke="black" points="353.5,-749 204.5,-749 204.5,-711 353.5,-711 353.5,-749"/>
<text text-anchor="middle" x="279" y="-733.8" font-family="Times,serif" font-size="14.00">start_conversation</text>
<text text-anchor="middle" x="279" y="-718.8" font-family="Times,serif" font-size="14.00">(AISH.jl)</text>
</g>
<!-- start&#45;&gt;user_input -->
<g id="edge10" class="edge">
<title>start&#45;&gt;user_input</title>
<path fill="none" stroke="black" d="M279,-710.71C279,-694.23 279,-669.78 279,-651.04"/>
<polygon fill="black" stroke="black" points="282.5,-651.04 279,-641.04 275.5,-651.04 282.5,-651.04"/>
<text text-anchor="middle" x="303.5" y="-683.4" font-family="Times,serif" font-size="12.00">Initiates</text>
</g>
</g>
</svg>
